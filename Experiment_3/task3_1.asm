ORG 0000H
	LJMP START
	
ORG 0013H
LJMP ADC_ISR
	
ORG 0060H
	START:
	MOV IE,#84H
	SETB IT1
	MOV DPTR,#0DFF8H
	MOVX @DPTR,A
	
	MAIN:
	;CALL READ
	MOV A,35H
	CALL CAL
	CALL DISPLAY
	CALL DELAY
	SJMP MAIN
	
ADC_ISR:
	PUSH PSW
	PUSH ACC
	MOV DPTR,#0DFF8H
	MOVX A,@DPTR
	MOV 35H,A
	MOV DPTR,#0DFF8H
	MOVX @DPTR,A
	POP ACC
	POP PSW
	RETI
	
		
READ:	
	MOV DPTR,#0DFF8H
	MOVX @DPTR,A
	WAIT:
	JNB P3.3,DONE
	SJMP WAIT
	DONE:
	MOVX A,@DPTR		
RET

CAL:
	MOV B,#50
	MUL AB
	MOV 31H,B
	MOV 30H,A
	MOV A,30H
	MOV B,#26
	DIV AB
	MOV 33H,A
	
	MOV A,31H
	MOV B,#10
	DIV AB
	MOV 32H,A
	MOV 31H,B
	
RET

DISPLAY:
	MOV A,31H
	ANL A,#0FH
	MOV DPTR,#DSEG2
	MOVC A,@A+DPTR
	MOV DPTR,#7FFAH
	MOVX @DPTR,A
	
	MOV A,32H
	ANL A,#0FH
	MOV DPTR,#DSEG1
	MOVC A,@A+DPTR
	MOV DPTR,#7FFBH
	MOVX @DPTR,A
	
	MOV A,33H
	ANL A,#0FH
	MOV DPTR,#DSEG1
	MOVC A,@A+DPTR
	MOV DPTR,#7FF9H
	MOVX @DPTR,A
	
	MOV A,#00H
	ANL A,#0FH
	MOV DPTR,#DSEG1
	MOVC A,@A+DPTR
	MOV DPTR,#7FF8H
	MOVX @DPTR,A

RET

DELAY:
	MOV R7,#0FFH
	LOOP1:
	MOV R6,#0FFH
	LOOP2:
	NOP
	DJNZ R6,LOOP2
	DJNZ R7,LOOP1
RET


DSEG1:
	DB 0C0H,0F9H,0A4H,0B0H
	DB 99H,92H,82H,0F8H
	DB 80H,90H,88H,83H
	DB 0C6H,0A1H,86H,8EH
		
DSEG2:
	DB 70H,79H,24H,30H
	DB 19H,12H,02H,78H
	DB 00H,10H,08H,03H
	DB 46H,21H,06H,0EH	
		
	END